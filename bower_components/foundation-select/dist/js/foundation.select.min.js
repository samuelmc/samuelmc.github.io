"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,s,i){return s&&e(t.prototype,s),i&&e(t,i),t}}();!function(e){var t=function(){function t(s,i){return _classCallCheck(this,t),this.$select=s,this.$select.is("select")?(this.options=e.extend({},t.defaults,this.$select.data(),i),this.$select.prop("multiple")?this._initMultiple():this._init(),Foundation.registerPlugin(this,"Select"),void Foundation.Keyboard.register("Select",{SPACE:"open",ESCAPE:"close",TAB:"tab",SHIFT_TAB:"tab",ARROW_UP:"select_up",ARROW_DOWN:"select_down"})):void console.warn("The select can only be used on a <select> element.")}return _createClass(t,[{key:"_initMultiple",value:function(){var t=this,s=Foundation.GetYoDigits(6,"select"),i=e('label[for="'+this.$select.attr("id")+'"]'),l=e('<div class="select-wrapper">'),n=e('<div class="select-container">'),o=e("<div data-perfect-scrollbar>");this.$select.wrap(l),this.$select.after(n),this.$element=e('<div id="'+s+'" class="multiple-select" tabindex="0">'),this.$element.append(o),n.append(this.$element),i.attr("for",s),this.$list=e("<ul>"),o.append(this.$list),this.$options={},this.$autoSelect=[],this.$select.find("option").each(this._setOption.bind(this)),this.$element.attr("placeholder",this.options.placeholder),n.foundation(),this._eventsMultiple(),this.$autoSelect.length&&e.each(this.$autoSelect,function(e,s){t.$options[s].find("a").trigger("click")})}},{key:"_init",value:function(){var t=this,s=Foundation.GetYoDigits(6,"select"),i=Foundation.GetYoDigits(6,"select-dropdown"),l=e('label[for="'+this.$select.attr("id")+'"]'),n=e('<div class="select-wrapper">'),o=e('<div class="select-container">');this.$select.wrap(n),this.$select.after(o),this.$element=e('<input type="text" id="'+s+'" data-toggle="'+i+'" readonly>'),o.append(this.$element),l.attr("for",s),this.$selectTriangle=e('<i class="select-triangle fa '+this.options.iconClass+'" data-toggle="'+i+'">'),o.append(this.$selectTriangle),this.$scroll=e("<div data-perfect-scrollbar>"),this.$dropdown=e("<div>"),this.$dropdown.attr({id:i,class:"select-dropdown","data-dropdown":"","data-v-offset":this.options.dropdownOffset,"data-h-offset":0,"data-close-on-click":!0}),this.$dropdown.append(this.$scroll),o.append(this.$dropdown),this.$list=e("<ul>"),this.$scroll.append(this.$list),this.$options={},this.$autoSelect=[],this._setPlaceholderOption(),this.$select.find("option").each(this._setOption.bind(this)),this.$element.attr("placeholder",this.options.placeholder),o.foundation(),this._events(),this.$autoSelect.length&&e.each(this.$autoSelect,function(e,s){t.$options[s].find("a").trigger("click")})}},{key:"_setPlaceholderOption",value:function(){var t=void 0;this.$select.find("option").each(function(s,i){""==e(i).val()&&(t=!0)}),t||""==this.options.placeholder||this.$select.prepend(e('<option value="">'+this.options.placeholder+"</option>"))}},{key:"_setOption",value:function(t,s){var i=e(s).val(),l=e(s).text();return""==i?void(this.options.placeholder=""==this.options.placeholder?l:this.options.placeholder):(e(s).is(":selected")&&(this.$autoSelect[this.$autoSelect.length]=i),void(this.$options[i]=e('<li><a data-value="'+i+'">'+l+"</a></li>").appendTo(this.$list)))}},{key:"_selectArrowDown",value:function(t){t.preventDefault();var s=e(this.$list.find("a.selected")[0]),i=void 0;i=s.parent().is(":last-child")?s:s.length>0?s.parent().next().find("a"):this.$list.find("li:first-child a"),this.$select.val(i.data("value")),this.$element.val(i.text()),this.$list.find("li a").removeClass("selected"),i.addClass("selected"),this.$dropdown.hasClass("is-open")&&this.$scroll.foundation("scrollToElement",i)}},{key:"_selectArrowUp",value:function(t){t.preventDefault();var s=e(this.$list.find("a.selected")[this.$list.find("a.selected").length-1]),i=void 0;s.parent().is(":first-child")||(i=s.length>0?s.parent().prev().find("a"):this.$list.find("li:last-child a"),this.$select.val(i.data("value")),this.$element.val(i.text()),this.$list.find("li a").removeClass("selected"),i.addClass("selected"),this.$dropdown.hasClass("is-open")&&this.$scroll.foundation("scrollToElement",i))}},{key:"_eventsMultiple",value:function(){var t=this;this.$element.add(this.$dropdown).off("keybord.zf.dropdown").on("keydown.zf.select",function(e){Foundation.Keyboard.handleKey(e,"Select",{select_down:function(){return t._selectArrowDown(e)},select_up:function(){return t._selectArrowUp(e)}})}),e.each(this.$options,function(s,i){var l=e(i).find("a");l.on("click",t.select.bind(t))})}},{key:"_events",value:function(){var t=this;this.$element.off("mousewheel.zf.select").on("mousewheel.zf.select",function(e){t.$element.is(":focus")&&t.options.mousewheel&&(e.originalEvent.deltaY>0?t._selectArrowDown(e):t._selectArrowUp(e))}).add(this.$dropdown).off("keybord.zf.dropdown").on("keydown.zf.select",function(e){Foundation.Keyboard.handleKey(e,"Select",{open:function(){$target.is(t.$element)&&(t.$dropdown.trigger("open"),t.$dropdown.attr("tabindex",-1).focus(),e.preventDefault())},select_down:function(){return t._selectArrowDown(e)},select_up:function(){return t._selectArrowUp(e)},tab:function(){t.$dropdown.trigger("close")},close:function(){t.$dropdown.trigger("close"),t.$element.focus()}})}),this.$dropdown.on("show.zf.dropdown",function(){t.$element.focus()}),e.each(this.$options,function(s,i){var l=e(i).find("a");l.on("click",t.select.bind(t))})}},{key:"select",value:function(t){t.preventDefault();var s=e(t.currentTarget),i=this,l=!1;this.$select.is("select[multiple]")&&(t.ctrlKey||t.isTrigger)?(t.ctrlKey&&e.each(this.$select.val(),function(e,t){if(s.data("value")==t){var n=i.$select.val();n.splice(e,1),i.$select.val(n),l=!0}}),l||this.$select.val((e.isArray(this.$select.val())?this.$select.val():[]).concat(s.data("value")))):this.$select.is("select[multiple]")?(this.$select.val(s.data("value")),this.$list.find("li a").removeClass("selected")):(this.$select.val(s.data("value")),this.$element.val(s.text()),this.$list.find("li a").removeClass("selected"),this.$dropdown.trigger("close")),l?s.removeClass("selected"):s.addClass("selected"),this.$element.trigger("selected.zf.select"),this.$select.trigger("change"),this.$element.focus()}},{key:"destroy",value:function(){this.$wrapper.after(this.$select.detach()),this.$wrapper.remove(),Foundation.unregisterPlugin(this)}}],[{key:"defaults",get:function(){return{iconClass:"fa-caret-down",placeholder:"",value:"",mousewheel:!0,dropdownOffset:0}}}]),t}();Foundation.plugin(t,"Select")}(jQuery);