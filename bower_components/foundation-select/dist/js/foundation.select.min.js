"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();!function(e){var t=function(){function t(i,s){return _classCallCheck(this,t),this.$select=i,this.$select.is("select")?(this.options=e.extend({},t.defaults,this.$select.data(),s),this.$select.prop("multiple")?this._initMultiple():this._init(),Foundation.registerPlugin(this,"Select"),void Foundation.Keyboard.register("Select",{SPACE:"open",ESCAPE:"close",TAB:"tab",SHIFT_TAB:"tab",ARROW_UP:"select_up",ARROW_DOWN:"select_down"})):void console.warn("The select can only be used on a <select> element.")}return _createClass(t,[{key:"_initMultiple",value:function(){var t=this,i=Foundation.GetYoDigits(6,"select"),s=e('label[for="'+this.$select.attr("id")+'"]'),l=e('<div class="select-wrapper">'),n=e('<div class="select-container">'),a=e("<div data-perfect-scrollbar>");this.$select.wrap(l),this.$select.after(n),this.$element=e('<div id="'+i+'" class="multiple-select" tabindex="0">'),this.$element.append(a),n.append(this.$element),s.attr("for",i),this.$list=e("<ul>"),a.append(this.$list),this.$options={},this.$autoSelect=[],this.$select.find("option").each(this._setOption.bind(this)),this.$element.attr("placeholder",this.options.placeholder),n.foundation(),this._eventsMultiple(),this.$autoSelect.length&&e.each(this.$autoSelect,function(e,i){t.$options[i].find("a").trigger("click")})}},{key:"_init",value:function(){var t=this,i=Foundation.GetYoDigits(6,"select"),s=Foundation.GetYoDigits(6,"select-dropdown"),l=e('label[for="'+this.$select.attr("id")+'"]'),n=e('<div class="select-wrapper">'),a=e('<div class="select-container">'),o=e("<div data-perfect-scrollbar>");this.$select.wrap(n),this.$select.after(a),this.$element=e('<input type="text" id="'+i+'" data-toggle="'+s+'" readonly>'),a.append(this.$element),l.attr("for",i),this.$selectTriangle=e('<i class="select-triangle fa '+this.options.iconClass+'" data-toggle="'+s+'">'),a.append(this.$selectTriangle),this.$dropdown=e("<div>"),this.$dropdown.attr({id:s,class:"select-dropdown","data-dropdown":"","data-v-offset":0,"data-h-offset":0,"data-close-on-click":!0}),this.$dropdown.append(o),a.append(this.$dropdown),this.$list=e("<ul>"),o.append(this.$list),this.$options={},this.$autoSelect=[],this.$select.find("option").each(this._setOption.bind(this)),this.$element.attr("placeholder",this.options.placeholder),a.foundation(),this._events(),this.$autoSelect.length&&e.each(this.$autoSelect,function(e,i){t.$options[i].find("a").trigger("click")})}},{key:"_setOption",value:function(t,i){var s=e(i).val(),l=e(i).text();return""==s?void(this.options.placeholder=""==this.options.placeholder?l:this.options.placeholder):(e(i).is(":selected")&&(this.$autoSelect[this.$autoSelect.length]=s),void(this.$options[s]=e('<li><a data-value="'+s+'">'+l+"</a></li>").appendTo(this.$list)))}},{key:"_selectArrowDown",value:function(t){t.preventDefault();var i=e(this.$list.find("a.selected")[this.$list.find("a.selected").length-1]),s=void 0;s=i.parent().is(":last-child")?i:i.length>0?i.parent().next().find("a"):this.$list.find("li:first-child a"),this.$select.val(s.data("value")),this.$element.val(s.text()),this.$list.find("li a").removeClass("selected"),s.addClass("selected"),s[0].scrollIntoView(!1)}},{key:"_selectArrowUp",value:function(t){t.preventDefault();var i=e(this.$list.find("a.selected")[this.$list.find("a.selected").length-1]),s=void 0;i.parent().is(":first-child")||(s=i.length>0?i.parent().prev().find("a"):this.$list.find("li:last-child a"),this.$select.val(s.data("value")),this.$element.val(s.text()),this.$list.find("li a").removeClass("selected"),s.addClass("selected"),s[0].scrollIntoView())}},{key:"_eventsMultiple",value:function(){var t=this;this.$element.add(this.$dropdown).off("keybord.zf.dropdown").on("keydown.zf.select",function(e){Foundation.Keyboard.handleKey(e,"Select",{select_down:function(){return t._selectArrowDown(e)},select_up:function(){return t._selectArrowUp(e)}})}),e.each(this.$options,function(i,s){var l=e(s).find("a");l.on("click",t.select.bind(t))})}},{key:"_events",value:function(){var t=this;this.$element.off("mousewheel.zf.select").on("mousewheel.zf.select",function(e){e.originalEvent.deltaY>0?t._selectArrowDown(e):t._selectArrowUp(e)}).add(this.$dropdown).off("keybord.zf.dropdown").on("keydown.zf.select",function(e){Foundation.Keyboard.handleKey(e,"Select",{open:function(){$target.is(t.$element)&&(t.$dropdown.trigger("open"),t.$dropdown.attr("tabindex",-1).focus(),e.preventDefault())},select_down:function(){return t._selectArrowDown(e)},select_up:function(){return t._selectArrowUp(e)},tab:function(){t.$dropdown.trigger("close")},close:function(){t.$dropdown.trigger("close"),t.$element.focus()}})}),e.each(this.$options,function(i,s){var l=e(s).find("a");l.on("click",t.select.bind(t))})}},{key:"select",value:function(t){t.preventDefault();var i=e(t.currentTarget),s=this,l=!1;this.$select.is("select[multiple]")&&(t.ctrlKey||t.isTrigger)?(t.ctrlKey&&e.each(this.$select.val(),function(e,t){if(i.data("value")==t){var n=s.$select.val();n.splice(e,1),s.$select.val(n),l=!0}}),l||this.$select.val((e.isArray(this.$select.val())?this.$select.val():[]).concat(i.data("value")))):this.$select.is("select[multiple]")?(this.$select.val(i.data("value")),this.$list.find("li a").removeClass("selected")):(this.$select.val(i.data("value")),this.$element.val(i.text()),this.$list.find("li a").removeClass("selected"),this.$dropdown.trigger("close")),l?i.removeClass("selected"):i.addClass("selected"),this.$element.trigger("selected.zf.select"),this.$select.trigger("change"),this.$element.focus()}},{key:"destroy",value:function(){this.$wrapper.after(this.$select.detach()),this.$wrapper.remove(),Foundation.unregisterPlugin(this)}}],[{key:"defaults",get:function(){return{iconClass:"fa-caret-down",placeholder:"",value:""}}}]),t}();Foundation.plugin(t,"Select")}(jQuery);